{% extends 'base.html.twig' %}

{% block title %}Panier{% endblock %}

{% block stylesheets %}
    <link href="/css/footerInner.css" rel="stylesheet">
{% endblock %}


{% block body %}

    {% include 'navbar/index2.html.twig' %}

<main id="main">
    <!-- ======= Breadcrumbs Section ======= -->
    <section class="breadcrumbs">
        <div class="container">

            <div class="d-flex justify-content-between align-items-center">
                <h2>Votre panier</h2>
                <ol>
                    <li><a href="{{ path('index')}}#hero">Acceuil</a></li>
                    <li>Votre panier</li>
                </ol>
            </div>
        </div>
    </section><!-- End Breadcrumbs Section -->
<section class="inner-page">
    <div class="container">


    {% if items | length > 0 %}


        <h3>Progression de la commande :</h3>

        <div class="progress">
            <div class="progress-bar" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">30</div>
        </div>


        <h1 class="mt-5 text-center">Votre panier</h1>

        <div class="table-responsive mt-5">
        <table class="table table-hover text-center" style="width:100%">
            <thead>
            <tr>
            <th>Produit</th>
            <th>Prix</th>
            <th>Quantite</th>
            <th>Total</th>
            <th>Supprimer</th>
            </tr>
            </thead>
            <tbody>
            {% for item in items %}
                <tr>
                    <td>{{ item.product.produit }}</td>
                    <td>
                        {% if item.product.type == 'jus' and item.quantity == 2 %}
                            4€
                        {% else %}
                            {{ item.product.prix }}€
                        {% endif%}
                    </td>
                    <td>{{ item.quantity }}
                    {% if item.product.type == 'entre' and item.quantity == 0  %}
                        <p class="text-danger">(Merci de rajouter une entree)</p>
                    {% endif %}
                    {% if item.product.type == 'plat' and item.quantity == 0  %}
                        <p class="text-danger">(Merci de rajouter un plat)</p>
                    {% endif %}
                    {% if item.product.type == 'dessert' and item.quantity == 0  %}
                        <p class="text-danger">(Merci de rajouter un dessert/fromage)</p>
                    {% endif %}
                    {% if item.product.type == 'dessert' and item.quantity == 1 and item.product.type == 'menu' and item.quantity == NULL %}
                        <p class="text-danger">Merci de rajouter le menu pour que votre commande soit prise en charge, merci</p>
                    {% endif %}
                    </td>
                    <td>
                        {% if item.product.type == 'jus' and item.quantity == 2 %}
                            8€
                        {% else %}
                        {{ item.product.prix * item.quantity }}€
                        {% endif%}
                    </td>

                    <td>
                        <a href="{{ path('panier_remove', {'id':item.product.id}) }}" class="btn btn-danger btn-sm"><i class='bx bx-trash-alt' ></i></a>
                    </td>
                </tr>
            {% endfor %}

            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-right">Total : </td>
                    <td>{{ total }}€</td>

                </tr>
            </tfoot>
        </table>
        </div>

        <div class="text-right">
        <button type="submit" class="btn" {% if total < 10 %} disabled="disabled" {% endif %} onclick="window.open('http://127.0.0.1:8000/accepte');">Continuer</button>
        </div>
<br><br><br>
        <h3 class="text-info text-center">En cas de commande d'un menu, assurer vous d'avoir une entree, un plat et un dessert</h3><br><br>
        <h3 class="text-info text-center">En cas d'ajout d'un produit du menu, votre commande sera valide a condition d'ajouter le menu a 14.50€</h3>
    {% else %}
        <h2 class="text-center mt-5 mb-5">Votre panier est vide ! </h2>
        <div class="text-center">
            <img src="/img/betiseetvolupthe.jpg" width="200" height="300"  alt="" class="pb-5">
        </div>
    {% endif %}
    </div>
</section>
</main>

{% endblock %}

    {% block javascripts %}
<script>

        var delay = 500;
        $(".progress-bar").each(function(i){
        $(this).delay( delay*i ).animate( { width: $(this).attr('aria-valuenow') + '%' }, delay );

        $(this).prop('Counter',0).animate({
        Counter: $(this).text()
        }, {
        duration: delay,
        easing: 'swing',
        step: function (now) {
        $(this).text(Math.ceil(now)+'%');
        }
        });
        });

</script>

    {% endblock %}
